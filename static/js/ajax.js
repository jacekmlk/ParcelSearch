function advAJAX(){var obj=new Object;obj.url=window.location.href;obj.method="GET";obj.parameters=new Object;obj.jsonParameters=new Object;obj.headers=new Object;obj.async=true;obj.mimeType="text/xml";obj.username=null;obj.password=null;obj.form=null;obj.disableForm=true;obj.unique=true;obj.uniqueParameter="_uniqid";obj.requestDone=false;obj.queryString="";obj.responseText=null;obj.responseXML=null;obj.status=null;obj.statusText=null;obj.aborted=false;obj.timeout=0;obj.retryCount=0;obj.retryDelay=1e3;obj.tag=null;obj.group=null;obj.progressTimerInterval=50;obj.xmlHttpRequest=null;obj.onInitialization=null;obj.onFinalization=null;obj.onReadyStateChange=null;obj.onLoading=null;obj.onLoaded=null;obj.onInteractive=null;obj.onComplete=null;obj.onProgress=null;obj.onSuccess=null;obj.onFatalError=null;obj.onError=null;obj.onTimeout=null;obj.onRetryDelay=null;obj.onRetry=null;obj.onGroupEnter=null;obj.onGroupLeave=null;obj.createXmlHttpRequest=function(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;var e=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"];for(var t=0;t<e.length;t++){try{var n=new ActiveXObject(e[t]);return n}catch(r){}}obj.raiseEvent("FatalError");return null};obj._oldResponseLength=null;obj._progressTimer=null;obj._progressStarted=navigator.userAgent.indexOf("Opera")==-1;obj._onProgress=function(){if(typeof obj.onProgress=="function"&&typeof obj.xmlHttpRequest.getResponseHeader=="function"){var e=obj.xmlHttpRequest.getResponseHeader("Content-length");if(e!=null&&e!=""){var t=obj.xmlHttpRequest.responseText.length;if(t!=obj._oldResponseLength){obj.raiseEvent("Progress",obj,t,e);obj._oldResponseLength=obj.xmlHttpRequest.responseText.length}}}if(obj._progressStarted)return;obj._progressStarted=true;var n=this;this.__onProgress=function(){obj._onProgress();obj._progressTimer=window.setTimeout(n.__onProgress,obj.progressTimerInterval)};n.__onProgress()};obj._onInitializationHandled=false;obj._initObject=function(){if(obj.xmlHttpRequest!=null){delete obj.xmlHttpRequest["onreadystatechange"];obj.xmlHttpRequest=null}if((obj.xmlHttpRequest=obj.createXmlHttpRequest())==null)return null;if(typeof obj.xmlHttpRequest.overrideMimeType!="undefined")obj.xmlHttpRequest.overrideMimeType(obj.mimeType);obj.xmlHttpRequest.onreadystatechange=function(){if(obj==null||obj.xmlHttpRequest==null)return;obj.raiseEvent("ReadyStateChange",obj,obj.xmlHttpRequest.readyState);obj._onProgress();switch(obj.xmlHttpRequest.readyState){case 1:obj._onLoading();break;case 2:obj._onLoaded();break;case 3:obj._onInteractive();break;case 4:obj._onComplete();break}};obj._onLoadingHandled=obj._onLoadedHandled=obj._onInteractiveHandled=obj._onCompleteHandled=false};obj._onLoading=function(){if(obj._onLoadingHandled)return;if(!obj._retry&&obj.group!=null){if(typeof advAJAX._groupData[obj.group]=="undefined")advAJAX._groupData[obj.group]=0;advAJAX._groupData[obj.group]++;if(typeof obj.onGroupEnter=="function"&&advAJAX._groupData[obj.group]==1)obj.onGroupEnter(obj)}obj.raiseEvent("Loading",obj);obj._onLoadingHandled=true};obj._onLoaded=function(){if(obj._onLoadedHandled)return;obj.raiseEvent("Loaded",obj);obj._onLoadedHandled=true};obj._onInteractive=function(){if(obj._onInteractiveHandled)return;obj.raiseEvent("Interactive",obj);obj._onInteractiveHandled=true;if(!obj._progressStarted)obj._onProgress()};obj._onComplete=function(){if(obj._onCompleteHandled||obj.aborted)return;if(obj._progressStarted){window.clearInterval(obj._progressTimer);obj._progressStarted=false}obj.requestDone=true;with(obj.xmlHttpRequest){obj.responseText=responseText;obj.responseXML=responseXML;if(typeof status!="undefined")obj.status=status;if(typeof statusText!="undefined")obj.statusText=statusText}obj.raiseEvent("Complete",obj);obj._onCompleteHandled=true;if(obj.status==200)obj.raiseEvent("Success",obj);else obj.raiseEvent("Error",obj);delete obj.xmlHttpRequest["onreadystatechange"];obj.xmlHttpRequest=null;if(obj.disableForm)obj.switchForm(true);obj._groupLeave();obj.raiseEvent("Finalization",obj)};obj._groupLeave=function(){if(obj.group!=null){advAJAX._groupData[obj.group]--;if(advAJAX._groupData[obj.group]==0)obj.raiseEvent("GroupLeave",obj)}};obj._retry=false;obj._retryNo=0;obj._onTimeout=function(){if(obj==null||obj.xmlHttpRequest==null||obj._onCompleteHandled)return;obj.aborted=true;obj.xmlHttpRequest.abort();obj.raiseEvent("Timeout",obj);obj._retry=true;if(obj._retryNo!=obj.retryCount){obj._initObject();if(obj.retryDelay>0){obj.raiseEvent("RetryDelay",obj);startTime=(new Date).getTime();while((new Date).getTime()-startTime<obj.retryDelay);}obj._retryNo++;obj.raiseEvent("Retry",obj,obj._retryNo);obj.run()}else{delete obj.xmlHttpRequest["onreadystatechange"];obj.xmlHttpRequest=null;if(obj.disableForm)obj.switchForm(true);obj._groupLeave();obj.raiseEvent("Finalization",obj)}};obj.run=function(){obj._initObject();if(obj.xmlHttpRequest==null)return false;obj.aborted=false;if(!obj._onInitializationHandled){obj.raiseEvent("Initialization",obj);obj._onInitializationHandled=true}if(obj.method=="GET"&&obj.unique)obj.parameters[encodeURIComponent(obj.uniqueParameter)]=(new Date).getTime().toString().substr(5)+Math.floor(Math.random()*100).toString();if(!obj._retry){for(var e in obj.parameters){if(obj.queryString.length>0)obj.queryString+="&";if(typeof obj.parameters[e]!="object")obj.queryString+=encodeURIComponent(e)+"="+encodeURIComponent(obj.parameters[e]);else{for(var t=0;t<obj.parameters[e].length;t++)obj.queryString+=encodeURIComponent(e)+"="+encodeURIComponent(obj.parameters[e][t])+"&";obj.queryString=obj.queryString.slice(0,-1)}}for(var e in obj.jsonParameters){var n=typeof [].toJSONString=="function";if(obj.queryString.length>0)obj.queryString+="&";obj.queryString+=encodeURIComponent(e)+"=";if(n)obj.queryString+=encodeURIComponent(obj.jsonParameters[e].toJSONString());else obj.queryString+=encodeURIComponent(obj.jsonParameters[e])}if(obj.method=="GET"&&obj.queryString.length>0)obj.url+=(obj.url.indexOf("?")!=-1?"&":"?")+obj.queryString}if(obj.disableForm)obj.switchForm(false);try{obj.xmlHttpRequest.open(obj.method,obj.url,obj.async,obj.username||"",obj.password||"")}catch(r){obj.raiseEvent("FatalError",obj,r);return}if(obj.timeout>0)setTimeout(obj._onTimeout,obj.timeout);if(typeof obj.xmlHttpRequest.setRequestHeader!="undefined")for(var e in obj.headers)obj.xmlHttpRequest.setRequestHeader(encodeURIComponent(e),encodeURIComponent(obj.headers[e]));if(obj.method=="POST"&&typeof obj.xmlHttpRequest.setRequestHeader!="undefined"){obj.xmlHttpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");obj.xmlHttpRequest.send(obj.queryString)}else if(obj.method=="GET")obj.xmlHttpRequest.send("")};obj.handleArguments=function(e){if(typeof e.form=="object"&&e.form!=null){obj.form=e.form;obj.appendForm()}for(a in e){if(typeof obj[a]=="undefined")obj.parameters[a]=e[a];else{if(a!="parameters"&&a!="headers")obj[a]=e[a];else for(b in e[a])obj[a][b]=e[a][b]}}obj.method=obj.method.toUpperCase()};obj.switchForm=function(enable){if(typeof obj.form!="object"||obj.form==null)return;with(obj.form)for(var nr=0;nr<elements.length;nr++)if(!enable){if(elements[nr]["disabled"])elements[nr]["_disabled"]=true;else elements[nr]["disabled"]="disabled"}else if(typeof elements[nr]["_disabled"]=="undefined")elements[nr].removeAttribute("disabled")};obj.appendForm=function(){with(obj.form){obj.method=getAttribute("method").toUpperCase();obj.url=getAttribute("action");for(var nr=0;nr<elements.length;nr++){var e=elements[nr];if(e.disabled)continue;switch(e.type){case"text":case"password":case"hidden":case"textarea":obj.addParameter(e.name,e.value);break;case"select-one":if(e.selectedIndex>=0)obj.addParameter(e.name,e.options[e.selectedIndex].value);break;case"select-multiple":for(var nr2=0;nr2<e.options.length;nr2++)if(e.options[nr2].selected)obj.addParameter(e.name,e.options[nr2].value);break;case"checkbox":case"radio":if(e.checked)obj.addParameter(e.name,e.value);break}}}};obj.addParameter=function(e,t){if(typeof obj.parameters[e]=="undefined")obj.parameters[e]=t;else if(typeof obj.parameters[e]!="object")obj.parameters[e]=[obj.parameters[e],t];else obj.parameters[e][obj.parameters[e].length]=t};obj.delParameter=function(e){delete obj.parameters[e]};obj.raiseEvent=function(e){var t=[];for(var n=1;n<arguments.length;n++)t.push(arguments[n]);if(typeof obj["on"+e]=="function")obj["on"+e].apply(null,t);if(e=="FatalError")obj.raiseEvent("Finalization",obj)};if(typeof advAJAX._defaultParameters!="undefined")obj.handleArguments(advAJAX._defaultParameters);return obj}advAJAX.get=function(e){return advAJAX.handleRequest("GET",e)};advAJAX.post=function(e){return advAJAX.handleRequest("POST",e)};advAJAX.head=function(e){return advAJAX.handleRequest("HEAD",e)};advAJAX.submit=function(e,t){if(typeof t=="undefined"||t==null)return-1;if(typeof e!="object"||e==null)return-2;var n=new advAJAX;t["form"]=e;n.handleArguments(t);return n.run()};advAJAX.assign=function(e,t){if(typeof t=="undefined"||t==null)return-1;if(typeof e!="object"||e==null)return-2;if(typeof e["onsubmit"]=="function")e["_onsubmit"]=e["onsubmit"];e["advajax_args"]=t;e["onsubmit"]=function(){if(typeof this["_onsubmit"]!="undefined"&&this["_onsubmit"]()===false)return false;if(advAJAX.submit(this,this["advajax_args"])==false)return true;return false};return true};advAJAX.download=function(e,t){if(typeof e=="string")e=document.getElementById(e);if(!e)return-1;advAJAX.get({url:t,onSuccess:function(t){e.innerHTML=t.responseText}})};advAJAX.scan=function(){var e=document.getElementsByTagName("a");for(var t=0;t<e.length;){if(e[t].getAttribute("rel")=="advancedajax"&&e[t].getAttribute("href")!==null){var n=e[t].getAttribute("href");var r=document.createElement("div");r.innerHTML=e[t].innerHTML;r.className=e[t].className;var i=e[t].parentNode;i.insertBefore(r,e[t]);i.removeChild(e[t]);advAJAX.download(r,n)}else t++}};advAJAX.handleRequest=function(e,t){if(typeof t=="undefined"||t==null)return-1;var n=new advAJAX;window.advajax_obj=n;n.method=e;n.handleArguments(t);return n.run()};advAJAX._defaultParameters=new Object;advAJAX.setDefaultParameters=function(e){advAJAX._defaultParameters=new Object;for(a in e)advAJAX._defaultParameters[a]=e[a]};advAJAX._groupData=new Object